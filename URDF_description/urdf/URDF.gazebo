<?xml version="1.0" ?>
<robot name="URDF" xmlns:xacro="http://www.ros.org/wiki/xacro" >

<xacro:property name="body_color" value="Gazebo/Silver" />

<!-- Gazebo Ignition Diff Drive Plugin -->
<gazebo>
  <plugin filename="ignition-gazebo-diff-drive-system"
          name="ignition::gazebo::systems::DiffDrive">

    <!-- Four wheels via two left/right pairs -->
    <left_joint>lf_wheel_to_coupling</left_joint>
    <left_joint>lr_wheel_to_coupling</left_joint>
    <right_joint>rf_wheel_to_coupling</right_joint>
    <right_joint>rr_wheel_to_coupling</right_joint>

    <wheel_separation>0.64</wheel_separation>
    <wheel_radius>0.1</wheel_radius>

    <!-- Gazebo-internal topic names (NOT ROS topics) -->
    <topic>cmd_vel</topic>
    <odom_topic>odom</odom_topic>
    <frame_id>odom</frame_id>
    <child_frame_id>base_link</child_frame_id>

    <max_linear_velocity>1.0</max_linear_velocity>
    <max_angular_velocity>2.0</max_angular_velocity>
    <max_linear_acceleration>1.0</max_linear_acceleration>
    <max_angular_acceleration>1.5</max_angular_acceleration>
    <max_wheel_torque>10</max_wheel_torque>
    <max_wheel_acceleration>1.0</max_wheel_acceleration>

  </plugin>

  <!-- Needed to publish TF odom->base_link into Gazebo -->
  <plugin filename="ignition-gazebo-pose-publisher-system"
          name="ignition::gazebo::systems::PosePublisher">
    <publish_link_pose>true</publish_link_pose>
    <publish_nested_model_pose>true</publish_nested_model_pose>
  </plugin>
</gazebo>

<!-- Lidar Sensor for Gazebo Ignition -->
<gazebo reference="lidar_link">
  <sensor name="lidar" type="gpu_lidar">
    <pose>0 0 0 0 0 0</pose>
    <always_on>true</always_on>
    <visualize>true</visualize>
    <update_rate>10</update_rate>
    <topic>/scan</topic>
    <lidar>
      <scan>
        <horizontal>
          <samples>360</samples>
          <resolution>1</resolution>
          <min_angle>-3.14159</min_angle>
          <max_angle>3.14159</max_angle>
        </horizontal>
      </scan>
      <range>
        <min>0.15</min>
        <max>12.0</max>
        <resolution>0.01</resolution>
      </range>
    </lidar>
    <plugin filename="ignition-gazebo-sensors-system"
            name="ignition::gazebo::systems::Sensors">
    </plugin>
  </sensor>
</gazebo>

<!-- Material and friction properties -->
<gazebo reference="base_link">
  <material>${body_color}</material>
  <mu1>0.2</mu1>
  <mu2>0.2</mu2>
  <self_collide>true</self_collide>
  <gravity>true</gravity>
</gazebo>

<gazebo reference="wheel_left_front_1">
  <material>${body_color}</material>
  <mu1>1.0</mu1>
  <mu2>1.0</mu2>
  <kp>1000000.0</kp>
  <kd>100.0</kd>
  <minDepth>0.001</minDepth>
  <maxVel>1.0</maxVel>
  <fdir1>1 0 0</fdir1>
  <self_collide>true</self_collide>
</gazebo>

<gazebo reference="wheel_left_rear_1">
  <material>${body_color}</material>
  <mu1>1.0</mu1>
  <mu2>1.0</mu2>
  <kp>1000000.0</kp>
  <kd>100.0</kd>
  <minDepth>0.001</minDepth>
  <maxVel>1.0</maxVel>
  <fdir1>1 0 0</fdir1>
  <self_collide>true</self_collide>
</gazebo>

<gazebo reference="wheel_right_rear_1">
  <material>${body_color}</material>
  <mu1>1.0</mu1>
  <mu2>1.0</mu2>
  <kp>1000000.0</kp>
  <kd>100.0</kd>
  <minDepth>0.001</minDepth>
  <maxVel>1.0</maxVel>
  <fdir1>1 0 0</fdir1>
  <self_collide>true</self_collide>
</gazebo>

<gazebo reference="wheel_right_front_1">
  <material>${body_color}</material>
  <mu1>1.0</mu1>
  <mu2>1.0</mu2>
  <kp>1000000.0</kp>
  <kd>100.0</kd>
  <minDepth>0.001</minDepth>
  <maxVel>1.0</maxVel>
  <fdir1>1 0 0</fdir1>
  <self_collide>true</self_collide>
</gazebo>

</robot>